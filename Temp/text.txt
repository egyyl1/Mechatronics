This is the longest code I have ever written in my life I will not be doing this again